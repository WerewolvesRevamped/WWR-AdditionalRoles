**Thief** | Unaligned Align | Variant
__Basics__ 
Each night, the Thief chooses one player to switch roles with. 
__Details__
When they switch with a player, they become that player's role, and the other player becomes the Thief. Role specific disguises are also switched.
Selecting a player to switch with is an immediate effect, but switching roles is an end night action and happens after any other end night actions such as night kills. The Thief can switch with a dead player, if the player was alive when they selected them. 
When switching with another player, all their channels are switched. Effects such as being powdered are not swapped. Effects are kept after switching, even if a player's new role cannot have that effect. In those cases the effect becomes dormant and does nothing; it will become active again if the player once again switches role.
If the Thief does not select a target, a random player is chosen. Each Thief may only select players that have never been that thief before.
The Thief wins if they are still alive at the end of the game or alternatively if there's no or only Unaligned players left to select, the Thief immediately ascends and wins. This can happen immediately after selecting a player.
The Thief's ability is more powerful than any other mechanic (even more powerful than those that claim they are the most powerful). If a Thief switches with a member of Hell, the current member of Hell betrays their team and becomes a Thief. Effectively the Thief changes the player behind the role, so if a demon switches with a thief, the demon doesn't truly betray the hell team - just the player behind the demon has changed.
If the Thief switches with a member of a cupid couple, that member betrays the couple to become a thief and the former thief joins the couple instead. 
The Thief is not affected by redirections.

__Simplified__
Each night, the Thief chooses one player to switch roles with. Each player can only be chosen once.
They win if they survive until the end of the game, or have already switched with all remaining players.

__Formalized__
Starting: Apply `Thief` to @Self
Immediate Night: Target @Selection [Attribute: @Selection lacks `Thief:@Self`] {Forced, Direct}
Passive End Night: Switch with @Target {Direct}
On End: Ascend
Passive: not (@(Class:!Unaligned,Attr:!Thief:@Self) exists): Ascend
